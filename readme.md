# Thai Text to Excel (Handwritten OCR)

แอปสำหรับสแกนรูปแล้วดึงข้อความภาษาไทย (รวมถึงลายมือ) ออกมาเป็นตาราง Excel
- รองรับอัปโหลดรูปหลายใบพร้อมกัน
- ตรวจจับว่ามีเส้นตารางหรือไม่ ถ้าไม่เป็นตารางจะเรียงตามตำแหน่งแกน x/y
- สามารถต่อข้อมูลกับไฟล์ Excel เดิมได้
- แสดงผลข้อความที่อ่านได้พร้อม confidence
- เลือกโหมดตารางเองหรือกำหนดค่า confidence ขั้นต่ำได้

## วิธีติดตั้ง

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

> หมายเหตุ: การติดตั้ง `torch` อาจใช้เวลานานขึ้นอยู่กับเครื่องและแพลตฟอร์ม

## วิธีใช้งาน

```bash
streamlit run app.py
```

## แนวคิดการประมวลผล

1. ใช้ EasyOCR สำหรับภาษาไทย/อังกฤษเพื่ออ่านข้อความในรูป
2. ตรวจจับเส้นแนวนอน/แนวตั้งแบบง่ายด้วย Hough line เพื่อเดาว่ารูปเป็นตารางหรือไม่
3. หากไม่ใช่ตาราง จะเรียงผลลัพธ์ตามตำแหน่งแกน y/x และส่งออกเป็นรายการพร้อมพิกัด
4. หากเป็นตาราง จะจัดกลุ่มข้อความตามตำแหน่งแกน y (แถว) และแกน x (คอลัมน์)
5. รวมผลลัพธ์หลายรูปเข้าด้วยกันและบันทึกเป็นไฟล์ Excel

> หมายเหตุ: การอ่านลายมือขึ้นกับคุณภาพรูปและความชัดเจนของลายมือ

## การฝึกโมเดลลายมือด้วยข้อมูลของคุณเอง

โปรเจกต์นี้มี pipeline สำหรับเตรียมข้อมูล/ตรวจสอบความถูกต้อง และ train โมเดล OCR แบบปรับแต่งเอง
ดูรายละเอียดที่ `training/README.md` ซึ่งครอบคลุมขั้นตอน:

- ตรวจสอบข้อมูล (validation)
- ใช้ระบบ Review เพื่อแก้ไข label ให้ถูกต้อง
- แบ่งชุด train/val และ train โมเดล recognition
- ประเมินผลด้วย CER/WER
